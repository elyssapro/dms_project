<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <div class="password-generation">
    <input type="text" id="newInput">
    <h2>Password Generator</h2>
    <div class="result-container">
        <span id="result"></span>

        <button class="btn" id="clipboard" style="display: none;">
            Copy
        </button>
    </div>

    <div class="settings" style="display: none;">
        <div class="setting">
            <label for="length">Password length</label>
            <input type="number" id="length" min="4" max="20" value="20" />
        </div>

        <div class="setting">
            <label for="uppercase">Include uppercase letters</label>
            <input type="checkbox" id="uppercase" checked>
        </div>

        <div class="setting">
            <label for="lowercase">Include lowercase letters</label>
            <input type="checkbox" id="lowercase" checked>
        </div>

        <div class="setting">
            <label for="numbers">Include numbers</label>
            <input type="checkbox" id="numbers" checked>
        </div>

        <div class="setting">
            <label for="symbols">Include symbols</label>
            <input type="checkbox" id="symbols" checked>
        </div>
    </div>

    <button class="btn btn-large" id="generate">
        Generate Password 
    </button>
</div>


<script>

const resultEl = document.getElementById('result')
const lengthEl = document.getElementById('length')
const lowercaseEl = document.getElementById('lowercase')
const uppercaseEl = document.getElementById('uppercase')
const numberEl = document.getElementById('numbers')
const symbolsEl = document.getElementById('symbols')
const generateEl = document.getElementById('generate')
const clipboardEl = document.getElementById('clipboard')

const randomFunc = {
    lower: getRandomLower,
    upper: getRandomUpper,
    number: getRandomNumber,
    symbol: getRandomSymbols
}

generateEl.addEventListener('click', () => {
    const length = +lengthEl.value;
    const hasLower = lowercaseEl.checked;
    const hasUpper = uppercaseEl.checked;
    const hasNumber = numberEl.checked;
    const hasSymbol = symbolsEl.checked;
    
    resultEl.textContent = generatePassword(hasLower, hasUpper, hasNumber, hasSymbol, length);
})


clipboardEl.addEventListener('click', function () {
    const textarea = document.createElement('textarea');
    const password = resultEl.innerText;

    if(!password) {
        return
    }

    textarea.value = password;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    textarea.remove();
    alert('Password copied to clipboard!')
})


function generatePassword(lower, upper, number, symbol, length) {
    /**
     * 1. Init Password variable
     * 2. Filter out unchecked types
     * 3. Loop over length call generator function for each type
     * 4. Add a final password to the password variable and return
     */

    let generatedPassword = '';
    const typeCount = lower + upper + number + symbol;
    // console.log('typecount ', typeCount);

    const typesArr = [{ lower }, { upper }, { number }, { symbol }].filter(item => Object.values(item)[0]);
    // console.log('TypesArr ', typesArr);

    if(typeCount === 0) {
        return '';
    }

    for(let i = 0; i < length; i += typeCount) {
        typesArr.forEach(type => {
            const funcName = Object.keys(type) [0];
            // console.log('funcName ', funcName);
            generatedPassword += randomFunc[funcName]();
        })
    }

    const finalPassword = generatedPassword.slice(0, length);
    // console.log(finalPassword);
    return document.getElementById('newInput').value = finalPassword;
}

/**
 * Generator Functions - http://www.net-comber.com/charset.html
 */

function getRandomLower() {
    return String.fromCharCode(Math.floor(Math.random() * 26) + 97)
}

function getRandomUpper () {
    return String.fromCharCode(Math.floor(Math.random() * 26) + 65);
}

function getRandomNumber () {
    return String.fromCharCode(Math.floor(Math.random() * 10) + 48)
}

function getRandomSymbols () {
    const symbols = '!@#$%^&*(){}[]=<>/,.';
    return symbols[Math.floor(Math.random() * symbols.length)];
}
</script>
</body>
</html>